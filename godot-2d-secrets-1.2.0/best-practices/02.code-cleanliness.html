<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>&#39;code cleanliness&#39;</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="data:text/css,%3Aroot%20%7B%2D%2Dcolor%2Dcaption%3A%20grey%3B%2D%2Dcolor%2Dblue%3A%20%2326bfe3%3B%2D%2Dcolor%2Dgreen%3A%20%2302e180%3B%2D%2Dcolor%2Dorange%3A%20%23f2971a%3B%2D%2Dcolor%2Dpink%3A%20%23e3266f%3B%2D%2Dcolor%2Dbg%3A%20%23fff%3B%2D%2Dcolor%2Dbg%2Dalt%3A%20%23f5f5f5%3B%2D%2Dcolor%2Dtext%2Dheader%3A%20%23fff%3B%2D%2Dcolor%2Dtext%2Dbody%3A%20%2395989a%3B%2D%2Dpadding%3A%2020px%3B%2D%2Dpadding%2Dinv%3A%20calc%28%2D1%20%2A%20var%28%2D%2Dpadding%29%29%3B%2D%2Dfonts%3A%20%27Open%20Sans%27%2C%20%2Dapple%2Dsystem%2C%20system%2Dui%2C%20%27Segoe%20UI%27%2C%20%27Roboto%27%2C%27Helvetica%20Neue%27%2C%20Arial%2C%20sans%2Dserif%3B%2D%2Dfont%2Dsize%3A%201%2E1rem%3B%7Dhtml%20%7Bfont%2Dsize%3A%20100%25%3B%7Dbody%20%7Bcolor%3A%20%23444%3Bfont%2Dfamily%3A%20var%28%2D%2Dfonts%29%3Bfont%2Dsize%3A%20var%28%2D%2Dfont%2Dsize%29%3Bline%2Dheight%3A%201%2E7%3Bpadding%3A%201em%3Bmargin%3A%20auto%3Bmax%2Dwidth%3A%20800px%3Bbackground%3A%20%23fefefe%3B%7Da%20%7Bcolor%3A%20%230645ad%3Btext%2Ddecoration%3A%20none%3B%7Da%3Avisited%20%7Bcolor%3A%20%230b0080%3B%7Da%3Ahover%20%7Bcolor%3A%20%2306e%3B%7Da%3Aactive%20%7Bcolor%3A%20%23faa700%3B%7Da%3Afocus%20%7Boutline%3A%20thin%20dotted%3B%7Da%3A%3Aselection%20%7Bbackground%3A%20rgba%28255%2C%20255%2C%200%2C%200%2E3%29%3Bcolor%3A%20%230645ad%3B%7D%2A%3A%3Aselection%20%7Bbackground%3A%20rgba%28255%2C%20255%2C%200%2C%200%2E3%29%3Bcolor%3A%20%23000%3B%7Dp%20%7Bmargin%3A%201em%200%3B%7D%2Ecaption%20%7Btext%2Dalign%3A%20center%3Bcolor%3A%20var%28%2D%2Dcolor%2Dcaption%29%3Bfont%2Dstyle%3A%20italic%3B%7D%2Enote%2C%2Etips%2C%2Ewarning%20%7Bdisplay%3A%20block%3Bwidth%3A%20calc%28100%25%20%2D%20var%28%2D%2Dpadding%29%20%2A%202%29%3Bpadding%3A%200%20var%28%2D%2Dpadding%29%3Bpadding%2Dbottom%3A%20var%28%2D%2Dpadding%29%3Bbackground%2Dcolor%3A%20var%28%2D%2Dcolor%2Dbg%2Dalt%29%3B%7D%2Enote%3Abefore%2C%2Etips%3Abefore%2C%2Ewarning%3Abefore%20%7Bdisplay%3A%20block%3Bmargin%3A%200%20var%28%2D%2Dpadding%2Dinv%29%2010px%20var%28%2D%2Dpadding%2Dinv%29%3Bpadding%2Dleft%3A%20var%28%2D%2Dpadding%29%3Bfont%2Dstyle%3A%20bold%3Bcolor%3A%20white%3B%7D%2Enote%3Abefore%20%7Bcontent%3A%20%27Note%27%3Bbackground%2Dcolor%3A%20var%28%2D%2Dcolor%2Dblue%29%3B%7D%2Etips%3Abefore%20%7Bcontent%3A%20%27Tips%27%3Bbackground%2Dcolor%3A%20var%28%2D%2Dcolor%2Dpink%29%3B%7D%2Ewarning%3Abefore%20%7Bcontent%3A%20%27Warning%27%3Bbackground%2Dcolor%3A%20var%28%2D%2Dcolor%2Dorange%29%3B%7Dimg%20%7Bmax%2Dwidth%3A%20100%25%3B%7Dh1%2Ch2%2Ch3%2Ch4%2Ch5%2Ch6%20%7Bcolor%3A%20%23111%3Bline%2Dheight%3A%20125%25%3Bmargin%2Dtop%3A%202em%3Bfont%2Dweight%3A%20normal%3B%7Dh4%2Ch5%2Ch6%20%7Bfont%2Dweight%3A%20bold%3B%7Dh1%20%7Bfont%2Dsize%3A%202%2E5em%3B%7Dh2%20%7Bfont%2Dsize%3A%202em%3B%7Dh3%20%7Bfont%2Dsize%3A%201%2E5em%3B%7Dh4%20%7Bfont%2Dsize%3A%201%2E2em%3B%7Dblockquote%20%7Bcolor%3A%20%23666666%3Bmargin%3A%200%3Bpadding%2Dleft%3A%203em%3Bborder%2Dleft%3A%200%2E5em%20%23eee%20solid%3B%7Dhr%20%7Bdisplay%3A%20block%3Bheight%3A%202px%3Bborder%3A%200%3Bborder%2Dtop%3A%201px%20solid%20%23aaa%3Bborder%2Dbottom%3A%201px%20solid%20%23eee%3Bmargin%3A%201em%200%3Bpadding%3A%200%3B%7Dpre%2Ccode%2Ckbd%2Csamp%20%7Bcolor%3A%20%230084b8%3Bfont%2Dfamily%3A%20monospace%2C%20monospace%3B%7Dpre%20%7Bpadding%3A%201em%3Bfont%2Dsize%3A%2014px%3Bwhite%2Dspace%3A%20pre%2Dwrap%3Bword%2Dwrap%3A%20break%2Dword%3B%7Dcode%20%7Bwhite%2Dspace%3A%20pre%2Dwrap%3B%7Db%2Cstrong%20%7Bfont%2Dweight%3A%20bold%3B%7Ddfn%20%7Bfont%2Dstyle%3A%20italic%3Bcolor%3A%20var%28%2D%2Dcolor%2Dblue%29%3B%7Dins%20%7Bbackground%3A%20%23ff9%3Bcolor%3A%20%23000%3Btext%2Ddecoration%3A%20none%3B%7Dul%2Col%20%7Bmargin%3A%201em%200%3Bpadding%3A%200%200%200%202em%3B%7Dli%20p%3Alast%2Dchild%20%7Bmargin%2Dbottom%3A%200%3B%7Dul%20ul%2Col%20ol%20%7Bmargin%3A%200%2E3em%200%3B%7Ddl%20%7Bmargin%2Dbottom%3A%201em%3B%7Ddt%20%7Bfont%2Dweight%3A%20bold%3Bmargin%2Dbottom%3A%200%2E8em%3B%7Ddd%20%7Bmargin%3A%200%200%200%2E8em%202em%3B%7Ddd%3Alast%2Dchild%20%7Bmargin%2Dbottom%3A%200%3B%7Dimg%20%7Bborder%3A%200%3B%2Dms%2Dinterpolation%2Dmode%3A%20bicubic%3Bvertical%2Dalign%3A%20middle%3B%7Dfigure%20%7Bdisplay%3A%20block%3Btext%2Dalign%3A%20center%3Bmargin%3A%201em%200%3B%7Dfigure%20img%20%7Bborder%3A%20none%3Bmargin%3A%200%20auto%3B%7Dfigcaption%20%7Bfont%2Dsize%3A%200%2E8em%3Bfont%2Dstyle%3A%20italic%3Bmargin%3A%200%200%200%2E8em%3B%7D%2Eauthor%20%7Bfont%2Dsize%3A%201%2E2em%3Btext%2Dalign%3A%20center%3B%7Dtag%20%7Bmin%2Dwidth%3A%203%2E2em%3Btext%2Dalign%3A%20center%3Bborder%2Dradius%3A%208px%3Bpadding%3A%200%204px%3Bmargin%2Dbottom%3A%200%3Bmargin%2Dtop%3A%204px%3Bmargin%2Dright%3A%200%2E2em%3Bdisplay%3A%20inline%2Dblock%3Bcolor%3A%20white%3B%7Dtag%2Eupdate%20%7Bbackground%3A%20var%28%2D%2Dcolor%2Dblue%29%3B%7Dtag%2Enew%20%7Bbackground%3A%20var%28%2D%2Dcolor%2Dgreen%29%3B%7Dtag%2Eupdate%3Aafter%20%7Bcontent%3A%20%27update%27%3B%7Dtag%2Enew%3Aafter%20%7Bcontent%3A%20%27new%27%3B%7Dbutton%20%7Bbackground%2Dcolor%3A%20var%28%2D%2Dcolor%2Dblue%29%3Bcolor%3A%20white%3Bborder%3A%20none%3Bcursor%3A%20pointer%3Bline%2Dheight%3A%202rem%3Bfont%2Dsize%3A%201%2E2rem%3Bmargin%3A%200%2E75rem%200%3Boverflow%3A%20visible%3Bpadding%3A%200%2E75rem%201%2E5rem%3Bborder%2Dradius%3A%201rem%3Btransition%3A%20background%2Dcolor%200%2E5%3Bwhite%2Dspace%3A%20nowrap%3B%7D%2Enode%2Dicon%20%7Bposition%3A%20relative%3Bbottom%3A%201%2E3px%3Bpadding%2Dright%3A%203px%3Bheight%3A%2018px%3B%7D%2Evideo%2Dyoutube%20%7Bbackground%2Dcolor%3A%20%23000%3Bposition%3A%20relative%3Bcursor%3A%20pointer%3B%7D%2Evideo%2Dyoutube%20%3E%20%2Eplaybutton%20%7Bpointer%2Devents%3A%20none%3Bwidth%3A%2090px%3Bheight%3A%2060px%3Bbackground%2Dcolor%3A%20%23333%3Bbox%2Dshadow%3A%200%200%2018px%20rgba%280%2C%200%2C%200%2C%200%2E6%29%3Bz%2Dindex%3A%201%3Bopacity%3A%200%2E8%3Bborder%2Dradius%3A%206px%3B%7D%2Eplaybutton%3Abefore%20%7Bcontent%3A%20%27%27%3Bborder%2Dstyle%3A%20solid%3Bborder%2Dwidth%3A%2015px%200%2015px%2026px%3Bborder%2Dcolor%3A%20transparent%20transparent%20transparent%20%23fff%3B%7D%2Evideo%2Dyoutube%20%3E%20img%2C%2Evideo%2Dyoutube%20%3E%20%2Eplaybutton%20%7Bcursor%3A%20pointer%3B%7D%2Evideo%2Dyoutube%20%3E%20img%2C%2Evideo%2Dyoutube%20%3E%20%2Eplaybutton%2C%2Evideo%2Dyoutube%20%3E%20%2Eplaybutton%3Abefore%20%7Bposition%3A%20absolute%3B%7D%2Eplaybutton%2C%2Eplaybutton%3Abefore%20%7Btop%3A%2050%25%3Bleft%3A%2050%25%3Btransform%3A%20translate3d%28%2D50%25%2C%20%2D50%25%2C%200%29%3B%7D" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="code-cleanliness-and-readability-tips">Code cleanliness and readability tips</h1>
<p>Even when you work alone on a project and code everything, you do not code for your eyes alone.</p>
<p>Days, weeks, months, or years into your project, you may need to track down an elusive bug or refactor an old system. You may be the one who coded it in the first place, but memory is a fickle thing; the odds of you remembering what each abbreviated, shorthanded variable name means or what a block of ambiguous logic means is low.</p>
<p>While it may make your code more verbose, it becomes easier to read, remember, and follow its logic by looking at variable names and functions.</p>
<p>On the other hand, if the code is clean and explicit, refamiliarizing yourself with it will be a lot easier. You don’t code <em>just</em> for yourself, but your future self too.</p>
<p>Help your future self. You’re their only hope.</p>
<h2 id="keep-function-and-variable-names-readable-and-descriptive">Keep function and variable names readable and descriptive</h2>
<p>Abbreviations, shorthand, and ambiguous names can save typing time but demand more brainpower if you forget what it meant down the line or if someone else has to read your code.</p>
<p>The problem becomes even more evident when you take the piece of code out of context, like when showing it to someone or asking for help on a chat server.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> rcvs_p<span style="color:#f92672">.</span>has(c):
    rcvs_p[c] <span style="color:#f92672">=</span> min(apow, rpow)
<span style="color:#66d9ef">else</span>:
    rcvs_p[c] <span style="color:#f92672">+=</span> min(apow, rpow)

apow <span style="color:#f92672">-=</span> rpow
</pre>
<p>Use actual, descriptive names where possible to make the logic more opaque and obvious. We are no longer coding on terminals of 80 characters or struggling with keeping code under 1 kilobyte of space.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> receivers_already_provided<span style="color:#f92672">.</span>has(cell):
    receivers_already_provided[cell] <span style="color:#f92672">=</span> min(available_power, power_required)
<span style="color:#66d9ef">else</span>:
    receivers_already_provided[cell] <span style="color:#f92672">+=</span> min(available_power, power_required)

available_power <span style="color:#f92672">-=</span> power_required
</pre>
<p>Some codified examples have well-understood shorthands already. When iterating through an array’s indices, you do not need to rename a simple <code>i</code> to <code>index</code>, or rename mathematical constants if it does not help readability.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> vertex_indices:
    <span style="color:#75715e">#...</span>
</pre>
<h2 id="wrap-ambiguous-conditionals-inside-nicely-named-variables">Wrap ambiguous conditionals inside nicely named variables</h2>
<p>Consider the following condition for an <code>if</code> statement:</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">if</span> _gui<span style="color:#f92672">.</span>blueprint <span style="color:#f92672">and</span> _gui<span style="color:#f92672">.</span>blueprint<span style="color:#f92672">.</span>placeable:
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> _simulation<span style="color:#f92672">.</span>entity_tracker<span style="color:#f92672">.</span>entities<span style="color:#f92672">.</span>has(cellv) <span style="color:#f92672">and</span> get_global_mouse_position()<span style="color:#f92672">.</span>distance_to(_player<span style="color:#f92672">.</span>global_position) <span style="color:#f92672">&lt;</span> MAXIMUM_WORK_DISTANCE <span style="color:#f92672">and</span> _ground<span style="color:#f92672">.</span>get_cellv(cellv) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
        <span style="color:#75715e">#...</span>
</pre>
<p>If you are intimate with the code base, you may know what each of those conditions implicitly means. But if you leave the project to sit for days, weeks, or months before returning to this line of code, or someone else comes in and takes a look at it, it means minutes or more tracking down what each stipulation implies.</p>
<p>If the condition is ambiguous about its meaning, split it up into clear, well-labeled variables.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">var</span> has_placeable_blueprint: <span style="color:#a6e22e">bool</span> <span style="color:#f92672">=</span> _gui<span style="color:#f92672">.</span>blueprint <span style="color:#f92672">and</span> _gui<span style="color:#f92672">.</span>blueprint<span style="color:#f92672">.</span>placeable

<span style="color:#66d9ef">var</span> is_close_to_player :<span style="color:#f92672">=</span> (
    get_global_mouse_position()<span style="color:#f92672">.</span>distance_to(_player<span style="color:#f92672">.</span>global_position) <span style="color:#f92672">&lt;</span> MAXIMUM_WORK_DISTANCE
)

<span style="color:#66d9ef">var</span> cell_is_occupied :<span style="color:#f92672">=</span> _simulation<span style="color:#f92672">.</span>entity_tracker<span style="color:#f92672">.</span>entities<span style="color:#f92672">.</span>has(cellv)
<span style="color:#66d9ef">var</span> is_on_ground :<span style="color:#f92672">=</span> _ground<span style="color:#f92672">.</span>get_cellv(cellv) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>

<span style="color:#66d9ef">if</span> has_placeable_blueprint:
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> cell_is_occupied <span style="color:#f92672">and</span> is_close_to_player <span style="color:#f92672">and</span> is_on_ground:
        <span style="color:#75715e">#...</span>
</pre>
<p>Here are some guidelines to find readable names:</p>
<ol type="1">
<li>Use <strong>nouns for data</strong> and <strong>verbs for functions</strong>. For example, <code>var weapons: Array</code> and <code>func walk_along_path()</code>. This helps to distinguish the two at a glance and will be especially useful with first-class functions in Godot 4.0.</li>
<li>Consider using a prefix for booleans: <code>has_placeable_blueprint</code> instead of <code>placeable_blueprint</code>. This clarifies that the value is either <code>true</code> or <code>false</code> and that it couldn’t reference a node or some other data.</li>
<li>Use the past tense for signals in Godot: they represent events that already occurred. For signals that represent the start or the end of a chain of events, we append “_started” or “_finished” to the name.</li>
<li>For classes and nodes, try to find names that instantly tell what their responsibility is. For example, in our tower defense demo, the node that places towers on the grid is named <code>TowerPlacer</code>.</li>
</ol>
<h2 id="keep-indented-blocks-shallow">Keep indented blocks shallow</h2>
<p>Having nested if statements or loops is inevitable in some cases, but you can keep your code looking a lot tidier by trying to keep as much of it as possible lined up with the left margin as possible.</p>
<p>The more indentation levels you have in a script, the more your eyes have to jump around to read and understand the code.</p>
<p>Limit the number of if statements inside if statements: you can rewrite certain condition chains into a single if. You can wrap <code>or</code> statements inside parentheses to maintain the logic, whereas you can chain <code>and</code> statements.</p>
<p>Instead of this:</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">if</span> gui<span style="color:#f92672">.</span>window<span style="color:#f92672">.</span>fuel <span style="color:#f92672">or</span> available_fuel <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0.0</span>:
    <span style="color:#66d9ef">if</span> gui<span style="color:#f92672">.</span>window<span style="color:#f92672">.</span>ore:
        <span style="color:#66d9ef">if</span> work<span style="color:#f92672">.</span>available_work <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0.0</span>:
            <span style="color:#75715e">#...</span>
</pre>
<p>You can write the condition on a single line.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">if</span> (gui<span style="color:#f92672">.</span>window<span style="color:#f92672">.</span>fuel <span style="color:#f92672">or</span> available_fuel <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0.0</span>) <span style="color:#f92672">and</span> gui<span style="color:#f92672">.</span>window<span style="color:#f92672">.</span>ore <span style="color:#f92672">and</span> work<span style="color:#f92672">.</span>available_work <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0.0</span>:
    <span style="color:#75715e">#...</span>
</pre>
<p>When you have many conditions and the line becomes difficult to read, you can use a variable to describe it.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">var</span> can_build: <span style="color:#a6e22e">bool</span> <span style="color:#f92672">=</span> (
    (gui<span style="color:#f92672">.</span>window<span style="color:#f92672">.</span>fuel <span style="color:#f92672">or</span> available_fuel <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0.0</span>) <span style="color:#f92672">and</span> gui<span style="color:#f92672">.</span>window<span style="color:#f92672">.</span>ore <span style="color:#f92672">and</span> work<span style="color:#f92672">.</span>available_work <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0.0</span>
)

<span style="color:#66d9ef">if</span> can_build:
    <span style="color:#75715e">#...</span>
</pre>
<p>You can do the same with functions. If the function only works on certain conditions, you can invert your <code>if</code> statement and return early.</p>
<p>Avoid the following.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">func</span> _unhandled_input(event: <span style="color:#a6e22e">InputEvent</span>) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> screen_fader<span style="color:#f92672">.</span>is_playing:
        <span style="color:#66d9ef">if</span> event is <span style="color:#a6e22e">InputEventKey</span> <span style="color:#f92672">or</span> event<span style="color:#f92672">.</span>is_action_pressed(<span style="color:#e6db74">&quot;thrust_forwards&quot;</span>):
            <span style="color:#75715e">#...</span>
</pre>
<p>Instead, you can do this.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">func</span> _unhandled_input(event: <span style="color:#a6e22e">InputEvent</span>) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#75715e"># Only run the function&#39;s body if the screen_fader is stopped.</span>
    <span style="color:#66d9ef">if</span> screen_fader<span style="color:#f92672">.</span>is_playing:
        <span style="color:#66d9ef">return</span>

    <span style="color:#66d9ef">if</span> event is <span style="color:#a6e22e">InputEventKey</span> <span style="color:#f92672">or</span> event<span style="color:#f92672">.</span>is_action_pressed(<span style="color:#e6db74">&quot;thrust_forwards&quot;</span>):
        <span style="color:#75715e">#...</span>
</pre>
<h2 id="prefer-calls-to-named-functions-over-nested-logic">Prefer calls to named functions over nested logic</h2>
<p>Try to keep functions doing more or less one job. For example, <code>_unhandled_input</code>’s job is to detect and parse user input and do something on specific inputs.</p>
<p>Its role is not to place an entity and update the neighboring entities.</p>
<p>Avoid putting a lot of code in an unrelated function like so.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">func</span> _unhandled_input(event: <span style="color:#a6e22e">InputEvent</span>) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#75715e">#...</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> cell_is_occupied <span style="color:#f92672">and</span> is_close_to_player <span style="color:#f92672">and</span> is_on_ground:
        <span style="color:#66d9ef">var</span> blueprint: BlueprintEntity <span style="color:#f92672">=</span> _gui<span style="color:#f92672">.</span>blueprint
        <span style="color:#66d9ef">var</span> blueprint_name: <span style="color:#a6e22e">String</span> <span style="color:#f92672">=</span> Library<span style="color:#f92672">.</span>get_filename_from(blueprint)

        <span style="color:#66d9ef">var</span> new_entity: <span style="color:#a6e22e">Node2D</span> <span style="color:#f92672">=</span> Library<span style="color:#f92672">.</span>entities[blueprint_name]<span style="color:#f92672">.</span>instance()
        <span style="color:#66d9ef">for</span> neighbor <span style="color:#f92672">in</span> Types<span style="color:#f92672">.</span>NEIGHBORS<span style="color:#f92672">.</span>keys():
        <span style="color:#66d9ef">var</span> key: <span style="color:#a6e22e">Vector2</span> <span style="color:#f92672">=</span> cellv <span style="color:#f92672">+</span> Types<span style="color:#f92672">.</span>NEIGHBORS[neighbor]
            <span style="color:#75715e">#etc...</span>
</pre>
<p>Instead, extract the logic inside functions to do that job, and have the original call those functions.</p>
<p>Give the new functions descriptive names so that, at a glance, you can tell what happens on which input. Coupled with wrapping your conditions inside descriptive variables and you can almost read the code like English.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">func</span> _unhandled_input(event: <span style="color:#a6e22e">InputEvent</span>) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#75715e">#...</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> cell_is_occupied <span style="color:#f92672">and</span> is_close_to_player <span style="color:#f92672">and</span> is_on_ground:
        _place_entity(cellv)
        _update_neighboring_flat_entities(cellv)
</pre>
<h2 id="reduce-repetition-cache-values">Reduce repetition: cache values</h2>
<p>If you have a particular conditional, value, or lookup you frequently use in a function’s body, you can make your code more readable by caching it ahead of time instead of repeating it.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">var</span> has_placeable_blueprint: <span style="color:#a6e22e">bool</span> <span style="color:#f92672">=</span> blueprint <span style="color:#f92672">and</span> blueprint<span style="color:#f92672">.</span>placeable
<span style="color:#66d9ef">var</span> cell_is_occupied :<span style="color:#f92672">=</span> _simulation<span style="color:#f92672">.</span>is_cell_occupied(cellv)
<span style="color:#66d9ef">var</span> is_on_ground :<span style="color:#f92672">=</span> _ground<span style="color:#f92672">.</span>get_cellv(cellv) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>

<span style="color:#66d9ef">var</span> is_close_to_player :<span style="color:#f92672">=</span> (
    global_mouse_position<span style="color:#f92672">.</span>distance_to(_player<span style="color:#f92672">.</span>global_position)
    <span style="color:#f92672">&lt;</span> MAXIMUM_WORK_DISTANCE
)

<span style="color:#66d9ef">if</span> event<span style="color:#f92672">.</span>is_action_pressed(<span style="color:#e6db74">&quot;left_click&quot;</span>):
    <span style="color:#66d9ef">if</span> has_placeable_blueprint:
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> cell_is_occupied <span style="color:#f92672">and</span> is_close_to_player <span style="color:#f92672">and</span> is_on_ground:
            _place_entity(cellv)
            _update_neighboring_flat_entities(cellv)

    <span style="color:#66d9ef">elif</span> cell_is_occupied <span style="color:#f92672">and</span> is_close_to_player:
        <span style="color:#66d9ef">var</span> entity :<span style="color:#f92672">=</span> _simulation<span style="color:#f92672">.</span>get_entity_at(cellv)
        <span style="color:#66d9ef">if</span> entity <span style="color:#f92672">and</span> entity<span style="color:#f92672">.</span>is_in_group(Types<span style="color:#f92672">.</span>GUI_ENTITIES):
            _gui<span style="color:#f92672">.</span>open_entity_gui(entity)
            _clear_hover_entity()
</pre>
<p>This also results in better performance, especially for expensive calls like <code>get_node()</code> (or its shorthand <code>$</code>).</p>
<h2 id="add-blank-lines-between-groups-of-relevant-lines-of-code">Add blank lines between groups of relevant lines of code</h2>
<p>A bit of breathing room will go a long way towards improving the readability. Consider the difference between the following two blocks of code. One breathes a little more and keeps the eye from glazing over as much.</p>
<pre style="color:#f8f8f2;background-color:#272822">    <span style="color:#66d9ef">if</span> event is <span style="color:#a6e22e">InputEventMouseButton</span>:
        _abort_deconstruct()
    <span style="color:#66d9ef">var</span> global_mouse_position :<span style="color:#f92672">=</span> get_global_mouse_position()
    <span style="color:#66d9ef">var</span> blueprint: BlueprintEntity <span style="color:#f92672">=</span> _gui<span style="color:#f92672">.</span>blueprint
    <span style="color:#66d9ef">var</span> has_placeable_blueprint: <span style="color:#a6e22e">bool</span> <span style="color:#f92672">=</span> blueprint <span style="color:#f92672">and</span> blueprint<span style="color:#f92672">.</span>placeable
    <span style="color:#66d9ef">var</span> is_close_to_player :<span style="color:#f92672">=</span> (
        global_mouse_position<span style="color:#f92672">.</span>distance_to(_player<span style="color:#f92672">.</span>global_position)
        <span style="color:#f92672">&lt;</span> MAXIMUM_WORK_DISTANCE
    )
    <span style="color:#66d9ef">var</span> cellv :<span style="color:#f92672">=</span> world_to_map(global_mouse_position)
    <span style="color:#66d9ef">var</span> cell_is_occupied :<span style="color:#f92672">=</span> _simulation<span style="color:#f92672">.</span>is_cell_occupied(cellv)
    <span style="color:#66d9ef">var</span> is_on_ground :<span style="color:#f92672">=</span> _ground<span style="color:#f92672">.</span>get_cellv(cellv) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>

</pre>
<p>By adding extra lines, we can visually group logic and read it more easily.</p>
<pre style="color:#f8f8f2;background-color:#272822">    <span style="color:#66d9ef">if</span> event is <span style="color:#a6e22e">InputEventMouseButton</span>:
        _abort_deconstruct()

    <span style="color:#66d9ef">var</span> global_mouse_position :<span style="color:#f92672">=</span> get_global_mouse_position()
    <span style="color:#66d9ef">var</span> blueprint: BlueprintEntity <span style="color:#f92672">=</span> _gui<span style="color:#f92672">.</span>blueprint
    <span style="color:#66d9ef">var</span> has_placeable_blueprint: <span style="color:#a6e22e">bool</span> <span style="color:#f92672">=</span> blueprint <span style="color:#f92672">and</span> blueprint<span style="color:#f92672">.</span>placeable

    <span style="color:#66d9ef">var</span> is_close_to_player :<span style="color:#f92672">=</span> (
        global_mouse_position<span style="color:#f92672">.</span>distance_to(_player<span style="color:#f92672">.</span>global_position)
        <span style="color:#f92672">&lt;</span> MAXIMUM_WORK_DISTANCE
    )

    <span style="color:#66d9ef">var</span> cellv :<span style="color:#f92672">=</span> world_to_map(global_mouse_position)
    <span style="color:#66d9ef">var</span> cell_is_occupied :<span style="color:#f92672">=</span> _simulation<span style="color:#f92672">.</span>is_cell_occupied(cellv)
    <span style="color:#66d9ef">var</span> is_on_ground :<span style="color:#f92672">=</span> _ground<span style="color:#f92672">.</span>get_cellv(cellv) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>
</pre>
<h2 id="when-commenting-code-avoid-obvious-comments">When commenting code, avoid obvious comments</h2>
<p>Comments are useful, but they should be helpful and not get in the way or make your codebase more cluttered. Use them when the code is not evident and when descriptive variable or function names are not enough.</p>
<p>Avoid commenting lines that are obvious from reading the code, such as in the following.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#75715e"># Converts the global mouse position from world to map coordinates.</span>
<span style="color:#66d9ef">var</span> cellv :<span style="color:#f92672">=</span> world_to_map(global_mouse_position)

<span style="color:#75715e"># Places the entity at the mouse map coordinates</span>
_place_entity(cellv)
</pre>
<p>The comments above paraphrase the code. Even worse, comments add maintenance work and tend to fall out of sync with the code. Over time, they can turn into <em>lies</em>.</p>
<p>That’s why you want to avoid superfluous comments. Use them sparingly, when they help to understand the code better.</p>
<p>Splitting logic into functions and using descriptive names greatly reduces the need for comments as it reduces the amount of ambiguous code.</p>
<h2 id="limit-line-length">Limit line length</h2>
<p>Unavoidably, some lines are going to become long. While you should not be <em>too</em> concerned about line length, a good practice is to keep lines of code below 100 characters. Going a little over is fine, but if you exceed it by a large margin, use parentheses and parameters to break up the line.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">func</span> _get_direction() <span style="color:#f92672">-&gt;</span> <span style="color:#a6e22e">Vector2</span>:
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Vector2</span>(
        (<span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>get_action_strength(<span style="color:#e6db74">&quot;right&quot;</span>) <span style="color:#f92672">-</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>get_action_strength(<span style="color:#e6db74">&quot;left&quot;</span>)) <span style="color:#f92672">*</span> <span style="color:#ae81ff">2.0</span>,
        <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>get_action_strength(<span style="color:#e6db74">&quot;down&quot;</span>) <span style="color:#f92672">-</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>get_action_strength(<span style="color:#e6db74">&quot;up&quot;</span>)
    )<span style="color:#f92672">.</span>normalized()
</pre>
<p>A code formatter will do that for you automatically. For GDScript code, you can use <a href="https://github.com/Scony/godot-gdscript-toolkit/">gdformat</a>.</p>
</body>
</html>
